{"ast":null,"code":"var _jsxFileName = \"/Users/codeep/WebstormProjects/Chat App/public/src/components/ChatContainer.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useRef, useState } from 'react';\nimport styled from \"styled-components\";\nimport Logout from \"./Logout\";\nimport ChatInput from \"./ChatInput\";\nimport axios from 'axios';\nimport { getAllMessagesRoute, sendMessageRoute } from \"../utils/APIRoutes\";\nimport { v4 as uuidv4 } from 'uuid';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction ChatContainer(_ref) {\n  _s();\n\n  let {\n    currentChat,\n    currentUser,\n    socket\n  } = _ref;\n  const [messages, setMessages] = useState([]);\n  const [arrivalMessage, setArrivalMessage] = useState(null);\n  const scrollRef = useRef();\n  useEffect(() => {\n    (async () => {\n      if (currentChat) {\n        const response = await axios.post(getAllMessagesRoute, {\n          from: currentUser._id,\n          to: currentChat._id\n        });\n        setMessages(response.data);\n      }\n    })();\n  }, [currentChat]);\n\n  const handleSendMsg = async msg => {\n    await axios.post(sendMessageRoute, {\n      from: currentUser._id,\n      to: currentChat._id,\n      message: msg\n    });\n    socket.current.emit(\"send-msg\", {\n      to: currentChat._id,\n      from: currentUser._id,\n      message: msg\n    });\n    const msgs = [...messages];\n    msg.push({\n      fromSelf: true,\n      message: msg\n    });\n    setMessages(msgs);\n  };\n\n  useEffect(() => {\n    if (socket.current) {\n      socket.current.on(\"msg-receive\", msg => {\n        setArrivalMessage({\n          fromSelf: false,\n          message: msg\n        });\n      });\n    }\n  }, []);\n  useEffect(() => {\n    arrivalMessage && setMessages(prev => [...prev, arrivalMessage]);\n  }, [arrivalMessage]);\n  useEffect(() => {\n    var _scrollRef$current;\n\n    (_scrollRef$current = scrollRef.current) === null || _scrollRef$current === void 0 ? void 0 : _scrollRef$current.scrollIntoView({\n      behavior: \"smooth\"\n    });\n  }, [messages]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: currentChat && /*#__PURE__*/_jsxDEV(Container, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"user-details\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"avatar\",\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: `data:image/svg+xml;base64,${currentChat.avatarImage}`,\n              alt: \"avatar\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 66,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 65,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"username\",\n            children: /*#__PURE__*/_jsxDEV(\"h3\", {\n              children: currentChat.username\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 72,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 71,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(Logout, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat-messages\",\n        children: messages.map(message => {\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            ref: scrollRef,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `message ${message.fromSelf ? \"sended\" : \"received\"}`,\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"content\",\n                children: /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: message.message\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 85,\n                  columnNumber: 49\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 84,\n                columnNumber: 45\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 81,\n              columnNumber: 41\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 37\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(ChatInput, {\n        handleSendMsg: handleSendMsg\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 17\n    }, this)\n  }, void 0, false);\n}\n\n_s(ChatContainer, \"JfFSEdQKAcT6qp/80mIe4QU2dtg=\");\n\n_c = ChatContainer;\nconst Container = styled.div`\n  display: grid;\n  grid-template-rows: 10% 80% 10%;\n  gap: 0.1rem;\n  overflow: hidden;\n  @media screen and (min-width: 720px) and (max-width: 1080px) {\n    grid-template-rows: 15% 70% 15%;\n  }\n  .chat-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0 2rem;\n    .user-details {\n      display: flex;\n      align-items: center;\n      gap: 1rem;\n      .avatar {\n        img {\n          height: 3rem;\n        }\n      }\n      .username {\n        h3 {\n          color: white;\n        }\n      }\n    }\n  }\n  .chat-messages {\n    padding: 1rem 2rem;\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n    overflow: auto;\n    &::-webkit-scrollbar {\n      width: 0.2rem;\n      &-thumb {\n        background-color: #ffffff39;\n        width: 0.1rem;\n        border-radius: 1rem;\n      }\n    }\n    .message {\n      display: flex;\n      align-items: center;\n      .content {\n        max-width: 40%;\n        overflow-wrap: break-word;\n        padding: 1rem;\n        font-size: 1.1rem;\n        border-radius: 1rem;\n        color: #d1d1d1;\n        @media screen and (min-width: 720px) and (max-width: 1080px) {\n          max-width: 70%;\n        }\n      }\n    }\n    .sended {\n      justify-content: flex-end;\n      .content {\n        background-color: #4f04ff21;\n      }\n    }\n    .received {\n      justify-content: flex-start;\n      .content {\n        background-color: #9900ff20;\n      }\n    }\n  }`;\n_c2 = Container;\nexport default ChatContainer;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"ChatContainer\");\n$RefreshReg$(_c2, \"Container\");","map":{"version":3,"names":["React","useEffect","useRef","useState","styled","Logout","ChatInput","axios","getAllMessagesRoute","sendMessageRoute","v4","uuidv4","ChatContainer","currentChat","currentUser","socket","messages","setMessages","arrivalMessage","setArrivalMessage","scrollRef","response","post","from","_id","to","data","handleSendMsg","msg","message","current","emit","msgs","push","fromSelf","on","prev","scrollIntoView","behavior","avatarImage","username","map","Container","div"],"sources":["/Users/codeep/WebstormProjects/Chat App/public/src/components/ChatContainer.jsx"],"sourcesContent":["import React, {useEffect, useRef, useState} from 'react';\nimport styled from \"styled-components\";\nimport Logout from \"./Logout\";\nimport ChatInput from \"./ChatInput\";\nimport axios from 'axios'\nimport {getAllMessagesRoute, sendMessageRoute} from \"../utils/APIRoutes\";\nimport {v4 as uuidv4} from 'uuid';\n\nfunction ChatContainer({currentChat, currentUser, socket}) {\n\n    const [messages, setMessages] = useState([]);\n    const [arrivalMessage, setArrivalMessage] = useState(null);\n    const scrollRef = useRef()\n    useEffect(() => {(async () => {\n        if(currentChat){\n            const response = await axios.post(getAllMessagesRoute, {\n                from: currentUser._id,\n                to: currentChat._id,\n            })\n            setMessages(response.data)\n        }\n    })()\n    }, [currentChat])\n\n    const handleSendMsg = async (msg) => {\n        await axios.post(sendMessageRoute,{\n            from: currentUser._id,\n            to: currentChat._id,\n            message: msg,\n        });\n        socket.current.emit(\"send-msg\",{\n            to: currentChat._id,\n            from: currentUser._id,\n            message: msg,\n        })\n\n        const msgs = [...messages];\n        msg.push({fromSelf: true, message: msg});\n        setMessages(msgs)\n    };\n\n    useEffect(()=>{\n        if(socket.current) {\n            socket.current.on(\"msg-receive\", (msg)=> {\n                setArrivalMessage({fromSelf: false,message:msg });\n            });\n        }\n    },[]);\n\n    useEffect(()=> {\n        arrivalMessage&& setMessages((prev) => [...prev, arrivalMessage])\n    }, [arrivalMessage]);\n\n\n    useEffect(()=>{\n        scrollRef.current?.scrollIntoView({behavior: \"smooth\"})\n    }, [messages])\n\n    return (\n        <>\n            {currentChat && (\n                <Container>\n                    <div className=\"chat-header\">\n                        <div className=\"user-details\">\n                            <div className='avatar'>\n                                <img\n                                    src={`data:image/svg+xml;base64,${currentChat.avatarImage}`}\n                                    alt=\"avatar\"\n                                />\n                            </div>\n                            <div className=\"username\">\n                                <h3>{currentChat.username}</h3>\n                            </div>\n                        </div>\n                        <Logout />\n                    </div>\n                    <div className='chat-messages'>\n                        {messages.map((message) => {\n                                return (\n                                    <div ref={scrollRef}>\n                                        <div className={`message ${\n                                            message.fromSelf ? \"sended\" : \"received\"\n                                        }`}>\n                                            <div className='content'>\n                                                <p>{message.message}</p>\n                                            </div>\n                                        </div>\n                                    </div>\n                                )\n                            })}\n                    </div>\n                    <ChatInput handleSendMsg = {handleSendMsg}/>\n                </Container>\n            )}\n        </>\n        )\n}\n\nconst Container = styled.div`\n  display: grid;\n  grid-template-rows: 10% 80% 10%;\n  gap: 0.1rem;\n  overflow: hidden;\n  @media screen and (min-width: 720px) and (max-width: 1080px) {\n    grid-template-rows: 15% 70% 15%;\n  }\n  .chat-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0 2rem;\n    .user-details {\n      display: flex;\n      align-items: center;\n      gap: 1rem;\n      .avatar {\n        img {\n          height: 3rem;\n        }\n      }\n      .username {\n        h3 {\n          color: white;\n        }\n      }\n    }\n  }\n  .chat-messages {\n    padding: 1rem 2rem;\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n    overflow: auto;\n    &::-webkit-scrollbar {\n      width: 0.2rem;\n      &-thumb {\n        background-color: #ffffff39;\n        width: 0.1rem;\n        border-radius: 1rem;\n      }\n    }\n    .message {\n      display: flex;\n      align-items: center;\n      .content {\n        max-width: 40%;\n        overflow-wrap: break-word;\n        padding: 1rem;\n        font-size: 1.1rem;\n        border-radius: 1rem;\n        color: #d1d1d1;\n        @media screen and (min-width: 720px) and (max-width: 1080px) {\n          max-width: 70%;\n        }\n      }\n    }\n    .sended {\n      justify-content: flex-end;\n      .content {\n        background-color: #4f04ff21;\n      }\n    }\n    .received {\n      justify-content: flex-start;\n      .content {\n        background-color: #9900ff20;\n      }\n    }\n  }`\n\nexport default ChatContainer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}